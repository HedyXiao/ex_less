function readfile(e){fs.readdir(e,function(i,s){for(var l=0;l<s.length;l++){var n=s[l],o=e+path.sep+n,f=fs.statSync(o);if(f.isDirectory())readfile(o);else{var c=new Date;c.getTime()/36e5,f.mtime.getTime()/36e5;n.indexOf(".less")>-1&&o.indexOf(path.sep+"lib"+path.sep)<0&&minify_css(o),n.indexOf(".js")>-1&&n.indexOf(".json")<0&&n.indexOf(".min.js")<0&&o.indexOf(path.sep+"dialog"+path.sep)<0&&minify_js(o)}}})}var fs=require("fs"),path=require("path"),UglifyJS=require("uglify-js"),child=require("child_process"),FileNum=0,JsFileNum=0,LessFileNum=0,minify_js=function(e){FileNum++,JsFileNum++,console.log("NO:"+FileNum+"-------------------"),console.log("源文件:",e);var i=e.replace(".js",".min.js"),s=UglifyJS.minify(e);fs.writeFile(i,s.code,function(e){}),console.log("目标文件:",i)},minify_css=function(e){FileNum++,LessFileNum++,console.log("NO:"+FileNum+"-------------------"),console.log("源文件:",e);var i=e.replace(/\/less\//gi,"/css/").replace(".less",".css");child.exec("lessc "+e+" "+i+" --compress"),console.log("目标文件:",i)};console.log("开始压缩-----------------------------------------");var filepath=".";readfile(filepath);